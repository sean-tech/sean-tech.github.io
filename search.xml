<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>iOS:密码学(哈希算法)</title>
      <link href="/2015/11/15/iOS-%E5%AF%86%E7%A0%81%E5%AD%A6(%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95)/"/>
      <url>/2015/11/15/iOS-%E5%AF%86%E7%A0%81%E5%AD%A6(%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95)/</url>
      
        <content type="html"><![CDATA[<p>这是一场不公平的战争，战争双方攻防不对等</p><a id="more"></a><h2 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h2><p>常见的加密算法有三种，哈希算法（散列函数），对称加密算法，以及非对称加密算法。三种加密算法分别有不同的应用场景，最常用的是综合搭配使用。</p><p>本篇内容主要说明Hash算法的使用。</p><h3 id="算法特点"><a href="#算法特点" class="headerlink" title="算法特点"></a>算法特点</h3><ol><li>算法公开；</li><li>对不同数据的加密结果是定长的32位字符；</li><li>加密不可逆；</li><li>破解方式：散列碰撞，找出两个不同的数据，加密之后得到相同的Hash值。</li></ol><h3 id="经典算法"><a href="#经典算法" class="headerlink" title="经典算法"></a>经典算法</h3><ol><li>MD5；</li><li>SHA1（256/512）；</li><li>HMAC。</li></ol><h2 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h2><h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ol><li>MD5（“信息指纹”,“信息-摘要”算法）；</li><li>压缩性 : 任意长度的数据,算出的 MD5 值长度都是固定的；</li><li>容易计算 : 从原数据计算出 MD5 值容易且高效；</li><li>抗修改性 : 对原数据进行任何改动,哪怕只修改一个字节,所得到的 MD5 值都有很大区别；</li><li>弱抗碰撞 : 已知原数据和其 MD5 值,想找到一个具有相同 MD5 值的数据(即伪造数据)是非常困难的；</li><li>强抗碰撞: 想找到两个不同数据,使他们具有相同的 MD5 值,是非常困难的。</li></ol><h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><ol><li>密码加密；</li><li>利用 MD5 来进行文件校验,被大量应用在软件下载站,论坛数据库,系统文件安全等方面(是否认为添加木马，篡改文件内容等)；</li><li>搜索引擎：iOS Sean 与 Sean iOS ，将关键字分别MD5后进行位运算可得相同结果；</li><li>云盘的秒传，根据MD5判断文件是否存在于服务器中;</li><li>一致性验证:MD5将整个文件当做一个大文本信息,通过不可逆的字符串变换算法,产生一个唯一的MD5信息摘要.就像每个人都有自己独一无二的指纹,MD5对任何文件产生一个独一无二的数字指纹;</li><li>数字签名;</li><li>安全访问认证。</li></ol><h2 id="SHA1（256-512）"><a href="#SHA1（256-512）" class="headerlink" title="SHA1（256/512）"></a>SHA1（256/512）</h2><h3 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a>特点</h3><p>SHA1（256/512）是继MD5之后的算法，一定程度上是MD5的替代</p><h3 id="应用-1"><a href="#应用-1" class="headerlink" title="应用"></a>应用</h3><p>SHA1（256/512）加密</p><h2 id="HMAC"><a href="#HMAC" class="headerlink" title="HMAC"></a>HMAC</h2><h3 id="特点-2"><a href="#特点-2" class="headerlink" title="特点"></a>特点</h3><p>在MD5和SHA1之上的补充，用一个密钥加密，然后做两次散列</p><h3 id="应用-2"><a href="#应用-2" class="headerlink" title="应用"></a>应用</h3><ol><li>加密；</li><li>设备锁（KEY保存到钥匙串中，以KEY为设备锁的依据）</li></ol><h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>我们通过代码模拟一下注册登录的流程，通过理论指导，实践验证哈希算法的具体应用场景</p><h3 id="直接MD5加密"><a href="#直接MD5加密" class="headerlink" title="直接MD5加密"></a>直接MD5加密</h3><p><strong>说明</strong>：直接MD5加密简单直接，但安全系数极低，没什么用。实例如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark - 加密方式1：直接MD5加密</span><br><span class="line">static NSString * Account1;</span><br><span class="line">static NSString * Password1;</span><br><span class="line">&#x2F;**</span><br><span class="line"> * 注册登录流程模拟1：MD5直接加密</span><br><span class="line"> *&#x2F;</span><br><span class="line">- (void)handleUserAccountPasswordBasedMD5 &#123;</span><br><span class="line">    </span><br><span class="line">    [self registerBasedMD5];</span><br><span class="line">    [self loginBasedMD5];</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;**</span><br><span class="line"> * 注册加密处理1:MD5直接加密</span><br><span class="line"> *&#x2F;</span><br><span class="line">- (void)registerBasedMD5 &#123;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;&#x2F; 本地账号密码处理</span><br><span class="line">    NSString * account &#x3D; @&quot;18918186688&quot;;</span><br><span class="line">    NSString * password &#x3D; @&quot;Sean12345678&quot;;</span><br><span class="line">    password &#x3D; password.md5String;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;&#x2F; 发送到服务器接收</span><br><span class="line">    Account1 &#x3D; account;</span><br><span class="line">    Password1 &#x3D; password;</span><br><span class="line">    NSLog(@&quot;The account server received is:%@&quot;, Account1);</span><br><span class="line">    NSLog(@&quot;The password server received is:%@&quot;, Password1);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;**</span><br><span class="line"> * 登录加密处理1:MD5直接加密</span><br><span class="line"> *&#x2F;</span><br><span class="line">- (void)loginBasedMD5 &#123;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;&#x2F; 本地账号密码处理</span><br><span class="line">    NSString * account &#x3D; @&quot;18918186688&quot;;</span><br><span class="line">    NSString * password &#x3D; @&quot;Sean12345678&quot;;</span><br><span class="line">    password &#x3D; password.md5String;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;&#x2F; 发送到服务器验证</span><br><span class="line">    if ([account isEqualToString:Account1] &amp;&amp; [password isEqualToString:Password1]) &#123;</span><br><span class="line">        NSLog(@&quot;登陆成功&quot;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        NSLog(@&quot;登陆失败&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="密码加盐后MD5加密"><a href="#密码加盐后MD5加密" class="headerlink" title="密码加盐后MD5加密"></a>密码加盐后MD5加密</h3><p><strong>说明</strong>：密码加盐后MD5加密比单纯加密要安全，但是弊端很明显：盐写死在程序，要更换盐代价很大，而且盐的泄漏风险很高。实例如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark - 加密方式2：密码加盐后MD5加密</span><br><span class="line">static NSString * Account2;</span><br><span class="line">static NSString * Password2;</span><br><span class="line">&#x2F;&#x2F;&#x2F;盐：盐要足够长，足够复杂.</span><br><span class="line">static NSString * salt &#x3D; @&quot;THIBSNNABKDAINDND91i2e9uqENSDDSJNDJNJSDNJ81838jaw92&quot;;</span><br><span class="line">&#x2F;**</span><br><span class="line"> * 注册登录流程模拟2：密码加盐后MD5加密</span><br><span class="line"> *&#x2F;</span><br><span class="line">- (void)handleUserAccountPasswordBasedSaltMD5 &#123;</span><br><span class="line">    </span><br><span class="line">    [self registerBasedSaltMD5];</span><br><span class="line">    [self loginBasedSaltMD5];</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;**</span><br><span class="line"> * 注册加密处理2:密码加盐后MD5加密</span><br><span class="line"> *&#x2F;</span><br><span class="line">- (void)registerBasedSaltMD5 &#123;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;&#x2F; 本地账号密码处理</span><br><span class="line">    NSString * account &#x3D; @&quot;18918186688&quot;;</span><br><span class="line">    NSString * password &#x3D; @&quot;Sean12345678&quot;;</span><br><span class="line">    password &#x3D; [password stringByAppendingString:salt].md5String;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;&#x2F; 发送到服务器接收</span><br><span class="line">    Account2 &#x3D; account;</span><br><span class="line">    Password2 &#x3D; password;</span><br><span class="line">    NSLog(@&quot;The account server received is:%@&quot;, Account2);</span><br><span class="line">    NSLog(@&quot;The password server received is:%@&quot;, Password2);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;**</span><br><span class="line"> * 登录加密处理2:密码加盐后MD5加密</span><br><span class="line"> *&#x2F;</span><br><span class="line">- (void)loginBasedSaltMD5 &#123;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;&#x2F; 本地账号密码处理</span><br><span class="line">    NSString * account &#x3D; @&quot;18918186688&quot;;</span><br><span class="line">    NSString * password &#x3D; @&quot;Sean12345678&quot;;</span><br><span class="line">    password &#x3D; [password stringByAppendingString:salt].md5String;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;&#x2F; 发送到服务器验证</span><br><span class="line">    if ([account isEqualToString:Account2] &amp;&amp; [password isEqualToString:Password2]) &#123;</span><br><span class="line">        NSLog(@&quot;登陆成功&quot;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        NSLog(@&quot;登陆失败&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="HMAC加密"><a href="#HMAC加密" class="headerlink" title="HMAC加密"></a>HMAC加密</h3><p><strong>说明</strong>：HMAC加密，KEY从服务器获取，此种加密相对较为安全，但同样有严重漏洞：网络传输过程中加密的HMAC字符串很容易泄漏，进而被攻击者模拟用户行为进行登录，获取用户数据。实例如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">#define KEY_ACCOUNTKEY @&quot;KEY_ACCOUNTKEY&quot;</span><br><span class="line">#define BUNDLEID [[NSBundle mainBundle] bundleIdentifier]</span><br><span class="line">static NSString * Account3;</span><br><span class="line">static NSString * Password3;</span><br><span class="line">&#x2F;**</span><br><span class="line"> * 注册登录流程模拟3：HMAC直接加密</span><br><span class="line"> *&#x2F;</span><br><span class="line">- (void)handleUserAccountPasswordBasedHMAC &#123;</span><br><span class="line">    </span><br><span class="line">    [self registerBasedHMAC];</span><br><span class="line">    [self loginBasedHMAC];</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;**</span><br><span class="line"> * 注册加密处理3:HMAC直接加密</span><br><span class="line"> *&#x2F;</span><br><span class="line">- (void)registerBasedHMAC &#123;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;&#x2F; 从服务器获取Key并保存到keychain</span><br><span class="line">    NSString * key &#x3D; @&quot;useraccount281818&quot;;</span><br><span class="line">    [SAMKeychain setPassword:key forService:BUNDLEID account:KEY_ACCOUNTKEY];</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;&#x2F; 本地账号密码处理</span><br><span class="line">    NSString * account &#x3D; @&quot;18918186688&quot;;</span><br><span class="line">    NSString * password &#x3D; @&quot;Sean12345678&quot;;</span><br><span class="line">    password &#x3D; [password hmacMD5StringWithKey:key];</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;&#x2F; 发送到服务器接收</span><br><span class="line">    Account3 &#x3D; account;</span><br><span class="line">    Password3 &#x3D; password;</span><br><span class="line">    NSLog(@&quot;The account server received is:%@&quot;, Account3);</span><br><span class="line">    NSLog(@&quot;The password server received is:%@&quot;, Password3);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;**</span><br><span class="line"> * 登录加密处理3:HMAC直接加密</span><br><span class="line"> *&#x2F;</span><br><span class="line">- (void)loginBasedHMAC &#123;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;&#x2F; 本地账号密码处理</span><br><span class="line">    NSString * account &#x3D; @&quot;18918186688&quot;;</span><br><span class="line">    NSString * password &#x3D; @&quot;Sean12345678&quot;;</span><br><span class="line">    NSString * key &#x3D; [SAMKeychain passwordForService:BUNDLEID account:KEY_ACCOUNTKEY];</span><br><span class="line">    if (!key) &#123;</span><br><span class="line">        &#x2F;&#x2F;&#x2F; 从服务器获取Key并保存到keychain</span><br><span class="line">        key &#x3D; @&quot;useraccount281818&quot;;</span><br><span class="line">        [SAMKeychain setPassword:key forService:BUNDLEID account:KEY_ACCOUNTKEY];</span><br><span class="line">    &#125;</span><br><span class="line">    password &#x3D; [password hmacMD5StringWithKey:key];</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;&#x2F; 发送到服务器验证</span><br><span class="line">    if ([account isEqualToString:Account3] &amp;&amp; [password isEqualToString:Password3]) &#123;</span><br><span class="line">        NSLog(@&quot;登陆成功&quot;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        NSLog(@&quot;登陆失败&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="（HMAC-时间戳）再MD5加密"><a href="#（HMAC-时间戳）再MD5加密" class="headerlink" title="（HMAC+时间戳）再MD5加密"></a>（HMAC+时间戳）再MD5加密</h3><p><strong>说明</strong>：密码+key进行HMAC加密，后拼接时间戳，然后再整体进行MD5加密。<br>​    这种方式有时间限定，加密的结果受时间影响很大，即使黑客获取密文模仿用户进行登录，也必须在2分钟内完成此操作，很大程度上增加了安全性。一般采用这种方式进行注册登录流程的加密。实例如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">static NSString * Account4;</span><br><span class="line">static NSString * Password4;</span><br><span class="line">&#x2F;**</span><br><span class="line"> * 注册登录流程模拟4:（HMAC加密+时间戳）再MD5加密</span><br><span class="line"> *&#x2F;</span><br><span class="line">- (void)handleUserAccountPasswordBasedHMACTimeStamp &#123;</span><br><span class="line">    </span><br><span class="line">    [self registerBasedHMACTimeStamp];</span><br><span class="line">    [self loginBasedHMACTimeStamp];</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;**</span><br><span class="line"> * 注册加密处理4:（HMAC加密+时间戳）再MD5加密(注册时发送给服务器的密码是不添加时间戳和再MD5处理的)</span><br><span class="line"> *&#x2F;</span><br><span class="line">- (void)registerBasedHMACTimeStamp &#123;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;&#x2F; 从服务器获取Key并保存到keychain</span><br><span class="line">    NSString * key &#x3D; @&quot;useraccount281818&quot;;</span><br><span class="line">    [SAMKeychain setPassword:key forService:BUNDLEID account:KEY_ACCOUNTKEY];</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;&#x2F; 本地账号密码处理</span><br><span class="line">    NSString * account &#x3D; @&quot;18918186688&quot;;</span><br><span class="line">    NSString * password &#x3D; @&quot;Sean12345678&quot;;</span><br><span class="line">    password &#x3D; [password hmacMD5StringWithKey:key];</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;&#x2F; 发送到服务器接收</span><br><span class="line">    Account4 &#x3D; account;</span><br><span class="line">    Password4 &#x3D; password;</span><br><span class="line">    NSLog(@&quot;The account server received is:%@&quot;, Account4);</span><br><span class="line">    NSLog(@&quot;The password server received is:%@&quot;, Password4);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;**</span><br><span class="line"> * 登录加密处理4:（HMAC加密+时间戳）再MD5加密</span><br><span class="line"> *&#x2F;</span><br><span class="line">- (void)loginBasedHMACTimeStamp &#123;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;&#x2F; 本地账号密码处理</span><br><span class="line">    NSString * account &#x3D; @&quot;18918186688&quot;;</span><br><span class="line">    NSString * password &#x3D; @&quot;Sean12345678&quot;;</span><br><span class="line">    NSString * key &#x3D; [SAMKeychain passwordForService:BUNDLEID account:KEY_ACCOUNTKEY];</span><br><span class="line">    if (!key) &#123;</span><br><span class="line">        &#x2F;&#x2F;&#x2F; 从服务器获取Key并保存到keychain</span><br><span class="line">        key &#x3D; @&quot;useraccount281818&quot;;</span><br><span class="line">        [SAMKeychain setPassword:key forService:BUNDLEID account:KEY_ACCOUNTKEY];</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F;&#x2F; 加时间戳</span><br><span class="line">    NSDateFormatter * dateFormatter &#x3D; [[NSDateFormatter alloc] init];</span><br><span class="line">    [dateFormatter setDateFormat:@&quot;YY-MM-dd hh:mm&quot;];</span><br><span class="line">    NSString * timeScale &#x3D; [dateFormatter stringFromDate:[NSDate dateWithTimeIntervalSinceNow:0]];</span><br><span class="line">    password &#x3D; [[password hmacMD5StringWithKey:key] stringByAppendingString:timeScale].md5String;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;&#x2F; 发送到服务器验证</span><br><span class="line">    BOOL isAccount &#x3D; [account isEqualToString:Account4];</span><br><span class="line">    &#x2F;&#x2F;&#x2F; 服务器添加时间戳后验证</span><br><span class="line">    NSString * timeScaleNow &#x3D; [dateFormatter stringFromDate:[NSDate dateWithTimeIntervalSinceNow:0]];</span><br><span class="line">    NSString * timeScaleLast &#x3D; [dateFormatter stringFromDate:[NSDate dateWithTimeIntervalSinceNow:0 - 60]];</span><br><span class="line">    NSString * passwordNow &#x3D; [Password4 stringByAppendingString:timeScaleNow].md5String;</span><br><span class="line">    NSString * passwordLast &#x3D; [Password4 stringByAppendingString:timeScaleLast].md5String;</span><br><span class="line">    BOOL isPassword &#x3D; [password isEqualToString:passwordNow] || [password isEqualToString:passwordLast];</span><br><span class="line">    </span><br><span class="line">    if (isAccount &amp;&amp; isPassword) &#123;</span><br><span class="line">        NSLog(@&quot;登陆成功&quot;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        NSLog(@&quot;登陆失败&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>md5，sha1，hmac，等算法，在不同的场景适于不同的使用方式，加密并不是一成不变的固定套路，要根据具体业务探索适合的加密方案；</p><p>安全方面的攻击和防御，是一场不对等的战争，防者千虑，可能也免不了疏忽，作为一线技术，能做的就是最大化的保证应用安全，而企业级的项目安全，需要的是成体系的安全防范方案，哈希加密只是其中的一小部分。</p>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 安全 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
